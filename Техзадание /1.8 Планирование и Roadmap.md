# 1.8 Планирование и Roadmap

#### 🎯 Зачем нужен roadmap

**Проблема хаотичной разработки с ИИ:**
- Начинаешь сразу кодить без плана
- Даёшь расплывчатые задачи ("создай мне backend")
- ИИ создаёт 2000 строк кода за раз
- Контекстное окно переполняется → ИИ останавливается
- Проект ломается, приходится переделывать
- Забываешь какие фичи планировал
- Нет видения прогресса
- Сложно вернуться после перерыва

**Roadmap решает:**
- ✅ Видишь всю картину проекта (этапы, задачи)
- ✅ Разбиваешь на маленькие задачи для ИИ (1-3 часа работы)
- ✅ ИИ не застревает (конкретные небольшие задания)
- ✅ Контекст не переполняется (по одной задаче)
- ✅ Отслеживаешь прогресс (чекбоксы [X])
- ✅ Легко возвращаешься к работе (видишь где остановился)
- ✅ Можешь скорректировать план (roadmap гибкий)

---

#### 🏗️ Аналогия

**Roadmap - это как строительство дома:**

**❌ Без roadmap:**
- "Построй мне дом" → строители не понимают что делать
- Начинают всё сразу (фундамент + стены + крыша)
- Заканчиваются материалы (контекст переполнился)
- Дом наполовину готов, но непонятно что дальше

**✅ С roadmap:**
- **Этап 1:** Фундамент (базовая структура проекта)
- **Этап 2:** Стены (основной функционал)
- **Этап 3:** Крыша (полировка, интеграции)
- Каждый этап разбит на конкретные задачи
- Видишь прогресс: фундамент готов ✅, стены 50% ⏳
- Можешь остановиться и продолжить позже

---

#### 📐 Структура roadmap.md

```markdown
# Project Roadmap: [Название проекта]

## 🎯 Цель проекта
[1-2 предложения что создаём и зачем]

## 📊 Текущий статус
- **Этап:** [Этап 1 / Этап 2 / Этап 3]
- **Прогресс:** [15/30 задач выполнено (50%)]
- **Следующее:** [Краткое описание следующей задачи]

## 🚀 Этапы разработки

### Этап 1: [Название] (сроки)
**Цель:** [Что должно получиться в результате этапа]

- [ ] Задача 1 (1-2 часа)
- [ ] Задача 2 (2-3 часа)
- [X] Задача 3 (выполнено)
- [ ] Задача 4 (1 час)

### Этап 2: [Название] (сроки)
**Цель:** [Что должно получиться]

- [ ] Задача 5
- [ ] Задача 6

### Этап 3: [Название] (сроки)
**Цель:** [Что должно получиться]

- [ ] Задача 7
- [ ] Задача 8

## 📝 Текущая сессия
[Записи что делал сегодня, проблемы, решения]

**2025-10-13:**
- [X] Настроил структуру проекта
- [X] Создал первый endpoint
- ⚠️ Проблема: CORS ошибка → Решение: добавил middleware
- ⏸️ Остановился на: добавление валидации
```

---

#### 💡 Принципы правильного roadmap

**1. Разбивай на этапы (3-5 этапов максимум)**

**Плохо:**
```markdown
- [ ] Создать проект
- [ ] Добавить всё остальное
```

**Хорошо:**
```markdown
### Этап 1: Базовая структура (неделя 1)
### Этап 2: Основной функционал (неделя 2-3)
### Этап 3: Интеграции и deploy (неделя 4)
```

---

**2. Каждая задача = 1-3 часа работы**

**❌ Слишком большая задача:**
```markdown
- [ ] Создать весь backend
```
Проблема: ИИ не знает с чего начать, создаст всё сразу, застрянет.

**✅ Правильно разбитые задачи:**
```markdown
- [ ] Создать структуру папок backend (30 мин)
- [ ] Настроить FastAPI main.py (30 мин)
- [ ] Создать первый endpoint GET /health (30 мин)
- [ ] Создать Pydantic модель Cam (1 час)
- [ ] Создать endpoint POST /api/cams (1-2 часа)
```

**Правило:** Если задача > 3 часов → разбей на подзадачи.

---

**3. Конкретные, измеримые задачи**

**❌ Расплывчато:**
```markdown
- [ ] Улучшить UI
- [ ] Добавить функционал
- [ ] Исправить баги
```

**✅ Конкретно:**
```markdown
- [ ] Добавить кнопку "Экспорт в DXF" на страницу Results
- [ ] Реализовать валидацию параметров кулачка (base_radius > 0)
- [ ] Исправить: CORS ошибка при запросе с frontend
```

---

**4. Группируй по логике, а не по технологиям**

**❌ Плохая группировка (по технологиям):**
```markdown
### Backend задачи
- [ ] Все endpoints
- [ ] Все модели
- [ ] Все сервисы

### Frontend задачи
- [ ] Все компоненты
- [ ] Все страницы
```

**✅ Хорошая группировка (по функционалу):**
```markdown
### Этап 1: CRUD для кулачков
- [ ] Backend: модель Cam
- [ ] Backend: endpoint POST /api/cams
- [ ] Frontend: форма ввода параметров
- [ ] Frontend: отображение результата

### Этап 2: Расчёты профиля
- [ ] Backend: service для расчётов
- [ ] Backend: endpoint POST /api/calculate
- [ ] Frontend: график профиля
```

Почему лучше: Видишь законченный функционал (feature), а не кусок технологии.

---

#### 🔄 Итеративная разработка (3 этапа)

**Принцип:** Не делай всё сразу. Разбивай на итерации.

```
┌─────────────────────────────────────────────────────────────┐
│                      ИТЕРАЦИЯ 1                             │
│                   Минимальный прототип                       │
│                      (1-2 недели)                            │
│                                                              │
│  Цель: Запустить ЧТО-ТО работающее                         │
│                                                              │
│  Backend:                        Frontend:                   │
│  • 1-2 модели данных            • Одна страница с формой    │
│  • CRUD для одной сущности      • Отправка данных           │
│  • Базовая валидация            • Отображение результата    │
│  • SQLite для dev                                           │
│                                                              │
│  Результат: Можешь показать работающий прототип             │
└─────────────────────────────────────────────────────────────┘
                           ↓
┌─────────────────────────────────────────────────────────────┐
│                      ИТЕРАЦИЯ 2                             │
│                  Расширение функционала                      │
│                      (2-4 недели)                            │
│                                                              │
│  Цель: MVP готов для тестирования                           │
│                                                              │
│  Backend:                        Frontend:                   │
│  • Все модели данных            • Несколько страниц         │
│  • Полный CRUD для всех         • Навигация                 │
│  • Связи между моделями         • Графики, визуализация     │
│  • Продвинутая валидация        • Обработка ошибок          │
│  • Обработка ошибок                                         │
│                                                              │
│  Результат: MVP готов для пользователей                     │
└─────────────────────────────────────────────────────────────┘
                           ↓
┌─────────────────────────────────────────────────────────────┐
│                      ИТЕРАЦИЯ 3                             │
│              Интеграции и Production                         │
│                      (2-3 недели)                            │
│                                                              │
│  Цель: Production-ready приложение                          │
│                                                              │
│  • Аутентификация (Clerk)       • Мониторинг                │
│  • Платежи (Stripe)             • Логирование               │
│  • Production БД (PostgreSQL)   • Error tracking            │
│  • Кэширование (Redis)          • Analytics                 │
│  • Deploy на хостинг                                        │
│  • CI/CD pipeline                                           │
│                                                              │
│  Результат: Приложение в production                         │
└─────────────────────────────────────────────────────────────┘
```

**Почему итерации важны:**
- ✅ Видишь результат быстро (1-2 недели до прототипа)
- ✅ Можешь скорректировать план (если что-то не так)
- ✅ Не застреваешь (всегда есть рабочая версия)
- ✅ ИИ не перегружается (конкретные маленькие задачи)

---

#### 🤖 Правило работы с ИИ и roadmap

**КРИТИЧНЫЙ WORKFLOW:**

```
1. СМОТРИШЬ roadmap.md
   ↓
   "Следующая задача: Создать endpoint POST /api/cams"

2. ФОРМУЛИРУЕШЬ задачу для ИИ
   ↓
   Конкретная задача (1-3 часа), ссылка на roadmap

3. ИИ ВЫПОЛНЯЕТ задачу
   ↓
   Claude Code создаёт код

4. ПРОВЕРЯЕШЬ результат
   ↓
   Запускаешь, тестируешь

5. ОБНОВЛЯЕШЬ roadmap
   ↓
   Отмечаешь [X] выполненное
   
6. ПОВТОРЯЕШЬ с шага 1
   ↓
   Следующая задача из roadmap
```

**Важно:** НЕ давай ИИ несколько больших задач сразу! По одной маленькой задаче.

---

#### 🎯 Диалоги с Claude Code

**❌ Плохой диалог (без roadmap):**
```
Ты: Создай мне весь backend для проекта EngineCamPro

Claude Code: [начинает создавать всё сразу]
[создаёт 50 файлов, 3000 строк кода]
[контекст переполняется]
[останавливается на середине]
[проект сломан]
```

**Проблемы:**
- Задача слишком большая
- ИИ не знает приоритеты
- Контекст переполнился
- Непонятно что делать с результатом

---

**✅ Хороший диалог (с roadmap):**
```
Ты: Смотри roadmap.md.

Текущий этап: "Этап 1: Базовая структура"
Следующая задача: "Создать структуру папок backend"

Создай структуру папок для FastAPI проекта:

backend/
├── app/
│   ├── main.py
│   ├── routers/      # API endpoints
│   ├── services/     # Бизнес-логика
│   ├── models/       # SQLAlchemy модели
│   ├── schemas/      # Pydantic схемы
│   └── core/         # Config, database
├── requirements.txt
└── .env.example

ЗАЧЕМ каждая папка:
- routers: отделить HTTP логику от бизнес-логики
- services: изолировать расчёты, легко тестировать
- models: работа с БД
- schemas: валидация API данных
- core: централизованные настройки

После завершения:
- Отметь задачу [X] в roadmap.md
- Добавь комментарий "✅ Структура создана"

Claude Code: [создаёт структуру папок]
[обновляет roadmap.md: - [X] Создать структуру папок]

✅ Задача выполнена за 10 минут, roadmap обновлён
```

**Почему хороший:**
- Ссылка на roadmap (ИИ видит контекст)
- Конкретная маленькая задача (30 минут)
- Объяснение ЗАЧЕМ (ИИ понимает цель)
- Требование обновить roadmap (отследить прогресс)

---

**✅ Следующая задача (итеративно):**
```
Ты: Смотри roadmap.md.

✅ Предыдущая задача выполнена: структура создана

Следующая задача: "Настроить FastAPI main.py"

Создай app/main.py:
- Базовая инициализация FastAPI
- CORS middleware (для frontend)
- Health check endpoint GET /health

Минимальный код, без излишеств.

После завершения отметь [X] в roadmap.md.

Claude Code: [создаёт main.py]
[обновляет roadmap.md]

✅ Задача выполнена за 15 минут
```

**Результат:** За 2 задачи по 15 минут у тебя рабочий каркас, roadmap обновлён, всё под контролем.

---

#### 📋 Шаблоны roadmap для разных проектов

**ШАБЛОН 1: Простое API (FastAPI + SQLite)**

```markdown
# Roadmap: Simple API Project

## 🎯 Цель
REST API для [описание]. Backend на FastAPI с SQLite.

## 📊 Текущий статус
- **Этап:** Этап 1 / 3
- **Прогресс:** 3/12 задач (25%)

## 🚀 Этапы

### Этап 1: Базовая структура (3-5 дней)
**Цель:** Запустить первый endpoint

- [ ] Создать структуру проекта (1 час)
- [ ] Настроить FastAPI main.py (30 мин)
- [ ] Создать SQLAlchemy модель (1 час)
- [ ] Создать Pydantic схему (1 час)
- [ ] Создать CRUD endpoints (2-3 часа)
- [ ] Добавить базовую валидацию (1 час)

### Этап 2: Расширение (5-7 дней)
**Цель:** Все фичи работают

- [ ] Добавить связи между моделями (2 часа)
- [ ] Обработка ошибок (1 час)
- [ ] Swagger документация (1 час)
- [ ] Написать тесты (2-3 часа)

### Этап 3: Deploy (2-3 дня)
**Цель:** В production

- [ ] .env для production (30 мин)
- [ ] Deploy на Railway/Vercel (1-2 часа)
- [ ] Настроить PostgreSQL (1 час)
```

---

**ШАБЛОН 2: Full-Stack (FastAPI + React)**

```markdown
# Roadmap: Full-Stack Application

## 🎯 Цель
Веб-приложение [описание]. FastAPI backend + React frontend.

## 📊 Текущий статус
- **Этап:** Этап 1 / 4
- **Прогресс:** 5/25 задач (20%)

## 🚀 Этапы

### Этап 1: Backend структура (неделя 1)
**Цель:** Backend API готов для frontend

Backend:
- [ ] Структура проекта (1 час)
- [ ] FastAPI setup (30 мин)
- [ ] SQLAlchemy модели (2-3 часа)
- [ ] CRUD endpoints (3-4 часа)
- [ ] Pydantic валидация (1-2 часа)
- [ ] CORS middleware (30 мин)

### Этап 2: Frontend структура (неделя 1)
**Цель:** Frontend интегрирован с backend

Frontend:
- [ ] Vite + React setup (30 мин)
- [ ] API service (fetch calls) (1-2 часа)
- [ ] Основные компоненты (2-3 часа)
- [ ] Форма ввода данных (2 часа)
- [ ] Отображение результатов (2 часа)

### Этап 3: Основной функционал (неделя 2-3)
**Цель:** MVP готов

- [ ] Расширенная валидация (2 часа)
- [ ] Обработка ошибок (backend + frontend) (2-3 часа)
- [ ] Графики/визуализация (3-4 часа)
- [ ] Навигация между страницами (2 часа)
- [ ] Улучшение UI (TailwindCSS) (3-4 часа)

### Этап 4: Deploy (неделя 4)
**Цель:** Production

- [ ] Backend deploy (Railway) (1-2 часа)
- [ ] Frontend deploy (Vercel) (1 час)
- [ ] Production БД (PostgreSQL) (1-2 часа)
- [ ] Environment variables (1 час)
```

---

**ШАБЛОН 3: RAG проект (AI Learning Assistant)**

```markdown
# Roadmap: AI Learning Assistant (RAG)

## 🎯 Цель
ИИ-наставник на основе RAG. Отвечает на вопросы по курсу используя векторную БД.

## 📊 Текущий статус
- **Этап:** Этап 1 / 5
- **Прогресс:** 0/35 задач (0%)
- **Следующее:** Создать структуру backend проекта

## 🚀 Этапы разработки

### Этап 1: Базовая структура (неделя 1)
**Цель:** Backend и Frontend каркас готов

Backend:
- [ ] Создать структуру папок (1 час)
  - app/routers/, app/services/, app/embeddings/, app/models/
- [ ] FastAPI setup + CORS (30 мин)
- [ ] .env.example с переменными (30 мин)
- [ ] Health check endpoint (15 мин)

Frontend:
- [ ] React + Vite setup (30 мин)
- [ ] Базовый Chat компонент (1-2 часа)
- [ ] WebSocket клиент (заглушка) (1 час)

Документация:
- [ ] README.md (1 час)
- [ ] docs/setup.md (1 час)
- [ ] docs/architecture.md (1 час)

### Этап 2: Векторная БД и embeddings (неделя 2)
**Цель:** Контент курса индексирован в векторной БД

- [ ] Pinecone аккаунт и API ключ (15 мин)
- [ ] Создать Pinecone index (dimensions: 1536) (15 мин)
- [ ] Настроить Pinecone client (app/embeddings/) (1 час)
- [ ] OpenAI API для embeddings (30 мин)
- [ ] Скрипт индексации: читать markdown файлы (1-2 часа)
- [ ] Text splitter (500 tokens, overlap 50) (1 час)
- [ ] Генерация embeddings для chunks (1 час)
- [ ] Загрузка в Pinecone (1 час)
- [ ] Тест: поиск по query (1 час)

### Этап 3: RAG логика (неделя 3)
**Цель:** RAG система работает, ответы генерируются

- [ ] LangChain setup (30 мин)
- [ ] RAG Service (app/services/rag_service.py) (2-3 часа)
  - Embedding query
  - Semantic search (Pinecone)
  - Формирование prompt с контекстом
- [ ] OpenAI Chat integration (1-2 часа)
- [ ] Endpoint POST /api/chat/message (2 часа)
- [ ] Тест через Swagger UI (30 мин)

### Этап 4: Real-time чат (неделя 4)
**Цель:** WebSocket streaming работает

Backend:
- [ ] WebSocket endpoint /ws/chat (2-3 часа)
- [ ] Streaming ответов от OpenAI (2 часа)
- [ ] Обработка ошибок (1 час)

Frontend:
- [ ] WebSocket клиент (real) (2 часа)
- [ ] Streaming UI (показывать текст по мере генерации) (2-3 часа)
- [ ] Markdown рендеринг (1 час)
- [ ] История сообщений в чате (2 часа)

### Этап 5: История чатов и улучшения (неделя 5)
**Цель:** Сохранение чатов, контекст, UI улучшен

- [ ] SQLAlchemy модели (Chat, Message) (1-2 часа)
- [ ] CRUD для чатов (2 часа)
- [ ] Контекст предыдущих сообщений (LangChain Memory) (2-3 часа)
- [ ] Frontend: список чатов (2 часа)
- [ ] Frontend: переключение между чатами (1-2 часа)
- [ ] Улучшение UI/UX (TailwindCSS) (3-4 часа)
- [ ] Обработка ошибок (frontend + backend) (2 часа)

### Этап 6: Deploy и финальная полировка (неделя 6)
**Цель:** Production-ready

- [ ] Backend deploy на Railway (1-2 часа)
- [ ] Frontend deploy на Vercel (1 час)
- [ ] Production Pinecone index (30 мин)
- [ ] Environment variables (production) (1 час)
- [ ] Тесты (основные flow) (3-4 часа)
- [ ] Логирование (1-2 часа)
- [ ] Rate limiting (защита от спама) (1-2 часа)
- [ ] CHANGELOG.md обновить (30 мин)

## 📝 Текущая сессия

**2025-10-13:**
- [ ] Начало: создать roadmap.md
- [ ] Изучить Project Setup Guide
```

---

#### ✅ Best Practices для roadmap

**DO (делай так):**

✅ **Разбивай большие задачи на маленькие** (1-3 часа)
```markdown
❌ - [ ] Создать весь backend
✅ - [ ] Создать структуру папок (1 час)
✅ - [ ] Создать модель Cam (1 час)
✅ - [ ] Создать endpoint POST /api/cams (2 часа)
```

✅ **Группируй по этапам/функционалу**
```markdown
### Этап 1: CRUD для кулачков
- [ ] Backend: модель
- [ ] Backend: endpoint
- [ ] Frontend: форма
```

✅ **Указывай примерное время** (помогает оценить объём)

✅ **Обновляй roadmap после КАЖДОЙ задачи** (отмечай [X])

✅ **Записывай проблемы и решения** (в секции "Текущая сессия")

✅ **Будь гибким** (можешь менять roadmap по ходу)

---

**DON'T (не делай так):**

❌ **Слишком детальный roadmap** (теряется общая картина)
```markdown
❌ - [ ] Создать файл app/main.py
❌ - [ ] Добавить строку import fastapi
❌ - [ ] Создать переменную app = FastAPI()
```

❌ **Слишком общий roadmap** (непонятно что делать)
```markdown
❌ - [ ] Сделать backend
❌ - [ ] Сделать frontend
❌ - [ ] Сделать деплой
```

❌ **Забывать обновлять** (roadmap устаревает)

❌ **Игнорировать roadmap при работе с ИИ** (даёшь задачи не из плана)

---

#### 🚦 Признаки что roadmap нужен рефакторинг

**Красные флаги:**

🚩 **Задачи слишком большие** (>3 часов)
→ Разбей на подзадачи

🚩 **ИИ застревает и не может закончить**
→ Задача слишком расплывчатая, сделай конкретнее

🚩 **Контекст переполняется**
→ Даёшь слишком большие задачи, уменьши

🚩 **Непонятно что делать дальше**
→ Добавь промежуточные задачи

🚩 **Roadmap не отражает реальность**
→ Обновляй регулярно, корректируй план

---

#### 📝 Workflow: от roadmap к коду

**Пример реальной сессии:**

```
ДЕНЬ 1: Начало проекта

1. Создаю roadmap.md (30 минут)
   - Определяю этапы
   - Разбиваю на задачи
   - Оцениваю время

2. Смотрю roadmap → первая задача
   "Создать структуру проекта"

3. Даю задачу Claude Code:
   "Смотри roadmap.md, создай структуру папок..."

4. Claude Code создаёт → проверяю → работает ✅

5. Обновляю roadmap:
   - [X] Создать структуру проекта

6. Следующая задача из roadmap:
   "Настроить FastAPI main.py"

7. Повторяю шаги 3-6...

---

КОНЕЦ ДНЯ:

Roadmap показывает:
- [X] 5 задач выполнено
- [ ] 2 задачи в процессе
- Прогресс: 25% (5/20 задач)

Записываю в roadmap:
"✅ За сегодня: структура готова, FastAPI настроен, первый endpoint работает"
"⏸️ Завтра: валидация и обработка ошибок"

---

ДЕНЬ 2: Продолжение

Открываю roadmap → вижу где остановился
→ Продолжаю следующую задачу
```

---

#### ✅ Чек-лист: Roadmap готов к работе

**Структура:**
- [ ] roadmap.md создан в корне проекта
- [ ] Есть цель проекта (1-2 предложения)
- [ ] Есть текущий статус (этап, прогресс)
- [ ] Разбито на 3-5 этапов

**Этапы:**
- [ ] Каждый этап имеет цель (что получится)
- [ ] Этапы логичны (прототип → MVP → production)
- [ ] Примерные сроки указаны

**Задачи:**
- [ ] Задачи конкретные и измеримые
- [ ] Каждая задача 1-3 часа работы
- [ ] Задачи с чекбоксами [ ] для отслеживания
- [ ] Нет задач типа "создать всё"

**Для работы с ИИ:**
- [ ] Задачи достаточно маленькие (ИИ не застрянет)
- [ ] Понятен следующий шаг (что делать сейчас)
- [ ] Можешь дать задачу ИИ напрямую из roadmap

**Процесс:**
- [ ] Обновляешь roadmap после каждой задачи
- [ ] Отмечаешь [X] выполненное
- [ ] Записываешь проблемы и решения

---

#### 🎯 Главное правило

**НИКОГДА не начинай кодить без roadmap!**

```
1. Создай roadmap.md (30-60 минут на планирование)
2. Разбей на маленькие задачи
3. Работай итеративно (по одной задаче)
4. Обновляй roadmap после каждой задачи
5. Корректируй план по ходу
```

**Правило 1 часа:**
- Потратить 1 час на планирование
- Сэкономить 10 часов на рефакторинге

---

**Следующий раздел:** 1.9 Рефакторинг: когда и как